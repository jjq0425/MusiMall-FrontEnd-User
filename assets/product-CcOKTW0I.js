import{_ as C,c as $,a as u,o as s,b,d as a,t as v,r as m,e as g,w as d,f as p,n as O,g as D,h as k,i as N,j as w,M as z,F as j,k as A,l as F}from"./index-CWJJL1Y1.js";import{_ as I}from"./SvgIcon-uK5CD8ag.js";const U={class:"price-stock"},E={key:0,class:"price"},R={key:1,class:"price",style:{color:"grey"}},T={class:"stock"},W={key:0,style:{color:"#f76707"}},G={key:1},X={key:2},H={key:3},J={__name:"PriceAndStockShow",props:{price:{type:Number,required:!0},remainQuantity:{type:Number,required:!0},totalQuantity:{type:Number,required:!0}},setup(e){const o=e,i=$(()=>o.price.toFixed(2)),r=$(()=>o.remainQuantity<=0),t=$(()=>o.remainQuantity<=20&&o.remainQuantity>0),_=$(()=>o.totalQuantity-o.remainQuantity<=20);return(y,h)=>(s(),u("div",U,[r.value?b("",!0):(s(),u("div",E," ￥ "+v(i.value),1)),r.value?(s(),u("div",R,"已售罄")):b("",!0),a("div",T,[t.value?(s(),u("span",W,"库存告急，仅剩"+v(e.remainQuantity)+"件",1)):_.value?(s(),u("span",G,"新品上架，欢迎选购")):r.value?(s(),u("span",X,"商品已售罄，关注其他商品吧")):(s(),u("span",H,"已售："+v(e.totalQuantity-e.remainQuantity)+" 库存: "+v(e.remainQuantity),1))])]))}},K=C(J,[["__scopeId","data-v-357e4803"]]),Y={style:{"border-radius":"12px"}},Z={__name:"ProductCard",props:{product:{type:Object,required:!0}},emits:["showProductDetailModal"],setup(e,{emit:o}){const i=e,r=()=>{t("showProductDetailModal",i.product.id)},t=o;return(_,y)=>{const h=m("a-image"),f=m("a-card-meta"),x=m("a-card");return s(),g(x,{hoverable:"",class:"product-card",onClick:r},{cover:d(()=>[a("div",Y,[p(h,{style:O([{overflow:"hidden"},{"border-radius":"12px 12px 18px 0"}]),width:"240px",height:"135px",src:e.product.picture,alt:e.product.name,preview:!1},null,8,["src","alt"])])]),default:d(()=>[p(f,{title:e.product.name,description:e.product.description.length>20?e.product.description.slice(0,18)+"...":e.product.description},{avatar:d(()=>[p(K,{style:{transform:"translateX(-5px)"},price:e.product.price,totalQuantity:e.product.quantity,remainQuantity:e.product.remainQuantity},null,8,["price","totalQuantity","remainQuantity"])]),_:1},8,["title","description"])]),_:1})}}},tt=C(Z,[["__scopeId","data-v-fed52398"]]),M="/api/product/v1",et=(e,o)=>D.get(`${M}/product`,{params:{page:e,pageSize:o,categoryName:null}}),ot=(e,o,i)=>D.get(`${M}/product/searchPage`,{params:{query:e,page:o,pageSize:i}}),at=e=>D.get(`${M}/product/${e}`),st={class:"product-detail-modal"},nt={class:"image-section"},it={class:"info-section"},rt={class:"product-name"},ct={class:"description"},lt={key:0,class:"price"},ut={key:1,class:"price",style:{color:"grey"}},dt={class:"stock-info"},pt={class:"stock-text"},mt={class:"stock-text"},_t={style:{"border-radius":"12px"},class:"footer"},vt={key:0,class:"total-price"},yt={key:1,class:"purchase"},ht={class:"purchase-btn-group"},gt={__name:"ProductDetailModal",setup(e,{expose:o}){const i=k(!1),r=k(1),t=N({id:1,name:"商品名称",description:"商品描述",picture:"",price:100,quantity:1e3,remainQuantity:1e3});o({showModal:async x=>{z.loading({content:"加载中...",id:"productDetail"});const n=await at(x).catch(P=>{z.error({content:`获取商品详情失败,请稍后再试:${P}`,id:"productDetail"})});n.id!=null&&(Object.assign(t,n),console.log(t),i.value=!0,z.success({content:"加载成功",id:"productDetail",duration:500}))}});const y=()=>{i.value=!1,z.success("已加入购物车")},h=()=>{},f=$(()=>(t.price*r.value).toFixed(2));return(x,n)=>{const P=m("a-image"),l=m("a-tag"),c=m("a-input-number"),S=m("a-modal");return s(),g(S,{visible:i.value,"onUpdate:visible":n[1]||(n[1]=Q=>i.value=Q),title:"商品详情",width:1200,footer:null},{default:d(()=>[a("div",st,[a("div",nt,[a("div",null,[p(P,{src:t.picture,alt:t.name,class:"product-image",width:"400px",height:"400px"},null,8,["src","alt"])])]),a("div",it,[a("h2",rt,v(t.name),1),a("p",ct,v(t.description),1),t.remainQuantity>0?(s(),u("div",lt," 单价: ￥"+v(t.price)+"/件 ",1)):(s(),u("div",ut,"已售罄")),a("div",dt,[a("span",pt," 已售: "+v(t.quantity-t.remainQuantity),1),a("span",mt," 剩余库存: "+v(t.remainQuantity),1),t.remainQuantity<=0?(s(),g(l,{key:0,color:"red",style:{"font-size":"12px"}},{default:d(()=>n[2]||(n[2]=[w(" 已售罄 ")])),_:1})):t.remainQuantity<=20?(s(),g(l,{key:1,color:"orange",style:{"font-size":"12px"}},{default:d(()=>n[3]||(n[3]=[w(" 库存告急 ")])),_:1})):t.quantity-t.remainQuantity<=20?(s(),g(l,{key:2,color:"green",style:{"font-size":"12px"}},{default:d(()=>n[4]||(n[4]=[w(" 新品发售 ")])),_:1})):(s(),g(l,{key:3,color:"blue",style:{"font-size":"12px"}},{default:d(()=>n[5]||(n[5]=[w("备货充足")])),_:1}))]),a("div",_t,[t.remainQuantity>0?(s(),u("div",vt,[n[6]||(n[6]=a("span",{style:{"font-weight":"bold"}},"总金额：",-1)),w(" ￥"+v(f.value),1)])):b("",!0),t.remainQuantity>0?(s(),u("div",yt,[a("div",null,[p(c,{style:{width:"220px"},placeholder:"Please Enter",mode:"button",size:"large",class:"input-demo",modelValue:r.value,"onUpdate:modelValue":n[0]||(n[0]=Q=>r.value=Q),min:1,max:t.remainQuantity},null,8,["modelValue","max"])]),a("div",ht,[a("div",{class:"purchase-btn",onClick:y},[p(I,{name:"shoppingCartWhite",size:"12px"}),n[7]||(n[7]=a("span",{style:{color:"white","font-weight":"bold","font-size":"15px"}}," 加入购物车 ",-1))]),a("div",{class:"purchase-btn-2",onClick:h},[p(I,{name:"makeOrderWhite",size:"13px"}),n[8]||(n[8]=a("span",{style:{color:"white","font-weight":"bold","font-size":"15px"}}," 直接购买 ",-1))])])])):b("",!0)])])])]),_:1},8,["visible"])}}},ft=C(gt,[["__scopeId","data-v-8f00a2f8"]]),xt={class:"product-list"},kt={__name:"ProductList",props:{productListInfo:{type:Array,required:!0}},setup(e){const o=k(null),i=r=>{o.value.showModal(r)};return(r,t)=>{const _=m("a-col"),y=m("a-row");return s(),u("div",xt,[p(y,{gutter:16},{default:d(()=>[(s(!0),u(j,null,A(e.productListInfo,h=>(s(),g(_,{key:h.id,span:6},{default:d(()=>[p(tt,{product:h,onShowProductDetailModal:i},null,8,["product"])]),_:2},1024))),128))]),_:1}),p(ft,{ref_key:"showProductDetailModalRef",ref:o},null,512)])}}},wt=C(kt,[["__scopeId","data-v-9d45e4f6"]]),bt={class:"search"},Pt={class:"search-Btn-Div"},Qt={class:"product-list-div"},$t={key:2,class:"pagination-div"},zt={__name:"product",setup(e){const o=k(""),i=k(!1),r=N([]),t=k(1),_=k(8),y=k(0);F(()=>{o.value="",f()});const h=()=>{o.value&&o.value.trim()!=""?x():f()},f=async()=>{i.value=!0;const l=await et(t.value,_.value);r.splice(0,r.length,...l.data),y.value=l.totalCount,i.value=!1},x=async()=>{i.value=!0,t.value=1;const l=await ot(o.value,t.value,_.value).catch(c=>{z.error("搜索失败,请稍后再试:"+c),i.value=!1});r.splice(0,r.length,...l.data),y.value=l.totalCount,i.value=!1},n=l=>{t.value=l,o.value?x():f()},P=l=>{t.value=1,_.value=l,o.value?x():f()};return(l,c)=>{const S=m("icon-search"),Q=m("a-input-search"),q=m("a-empty"),V=m("icon-loading"),L=m("a-pagination");return s(),u("div",null,[a("div",bt,[c[2]||(c[2]=a("div",{class:"title"},[a("h1",{style:{margin:"0 auto","text-align":"center","font-size":"45px"}}," 优选好物 ")],-1)),a("div",Pt,[p(Q,{class:"search-Btn",modelValue:o.value,"onUpdate:modelValue":c[0]||(c[0]=B=>o.value=B),placeholder:"输入商品关键词","search-button":"",onSearch:h,loading:i.value},{"button-icon":d(()=>[p(S)]),"button-default":d(()=>c[1]||(c[1]=[w(" 搜好物 ")])),_:1},8,["modelValue","loading"])])]),a("div",Qt,[r.length===0&&!i.value?(s(),g(q,{key:0,style:{"padding-top":"80px"}},{default:d(()=>c[3]||(c[3]=[w(" 没有搜索到商品 ")])),_:1})):i.value?(s(),g(q,{key:1,style:{"padding-top":"80px"}},{image:d(()=>[p(V,{style:{"font-size":"68px",color:"#165dff"}})]),default:d(()=>[c[4]||(c[4]=a("div",{style:{"margin-top":"25px","font-size":"20px"}},"加载中，请稍后...",-1))]),_:1})):b("",!0),p(wt,{"product-list-info":r},null,8,["product-list-info"]),c[5]||(c[5]=a("div",{style:{height:"50px"}},null,-1)),r.length>0?(s(),u("div",$t,[p(L,{total:y.value,current:t.value,"page-size":_.value,onChange:n,onPageSizeChange:P,"page-size-options":[8,16,32,64],"show-total":"","show-jumper":"","show-page-size":""},null,8,["total","current","page-size"])])):b("",!0)])])}}},Dt=C(zt,[["__scopeId","data-v-a6e38161"]]);export{Dt as default};
