import{_ as b,c as w,a as u,o as r,b as z,d as o,t as g,r as _,e as f,w as l,f as d,n as I,g as S,h as x,i as q,j as k,M as Q,F as D,k as A,l as U,m as F}from"./index-CeUjl_hY.js";const E={class:"price-stock"},R={key:0,class:"price"},T={key:1,class:"price",style:{color:"grey"}},W={class:"stock"},G={key:0,style:{color:"#f76707"}},X={key:1},H={key:2},J={key:3},K={__name:"PriceAndStockShow",props:{price:{type:Number,required:!0},remainQuantity:{type:Number,required:!0},totalQuantity:{type:Number,required:!0}},setup(t){const e=t,n=w(()=>e.price.toFixed(2)),i=w(()=>e.remainQuantity<=0),a=w(()=>e.remainQuantity<=100&&e.remainQuantity>0),m=w(()=>e.totalQuantity-e.remainQuantity<=100);return(v,h)=>(r(),u("div",E,[i.value?z("",!0):(r(),u("div",R," ￥ "+g(n.value),1)),i.value?(r(),u("div",T,"已售罄")):z("",!0),o("div",W,[a.value?(r(),u("span",G,"库存告急，仅剩"+g(t.remainQuantity)+"件",1)):m.value?(r(),u("span",X,"新品上架，欢迎选购")):i.value?(r(),u("span",H,"商品已售罄，关注其他商品吧")):(r(),u("span",J,"已售："+g(t.totalQuantity-t.remainQuantity)+" 库存: "+g(t.remainQuantity),1))])]))}},Y=b(K,[["__scopeId","data-v-b5bf57bd"]]),Z={style:{"border-radius":"12px"}},tt=["src","alt"],et={__name:"ProductCard",props:{product:{type:Object,required:!0}},emits:["showProductDetailModal"],setup(t,{emit:e}){const n=t,i=()=>{a("showProductDetailModal",n.product.id)},a=e;return(m,v)=>{const h=_("a-card-meta"),s=_("a-card");return r(),f(s,{hoverable:"",class:"product-card",onClick:i},{cover:l(()=>[o("div",Z,[o("img",{style:I([{width:"240px",height:"135px",overflow:"hidden"},{"border-radius":"12px 12px 12px 0"}]),src:t.product.picture,alt:t.product.name},null,8,tt)])]),default:l(()=>[d(h,{title:t.product.name,description:t.product.description},{avatar:l(()=>[d(Y,{style:{transform:"translateX(-5px)"},price:t.product.price,totalQuantity:t.product.quantity,remainQuantity:t.product.remainQuantity},null,8,["price","totalQuantity","remainQuantity"])]),_:1},8,["title","description"])]),_:1})}}},at=b(et,[["__scopeId","data-v-ca52456a"]]),C="/api/product/v1",ot=(t,e)=>S.get(`${C}/product`,{params:{page:t,pageSize:e,categoryName:null}}),st=(t,e,n)=>S.get(`${C}/product/searchPage`,{params:{query:t,page:e,pageSize:n}}),nt=t=>S.get(`${C}/product/${t}`),it=["fill"],rt=["xlink:href"],M={__name:"SvgIcon",props:{name:{type:String,default:""},color:{type:String,default:"black"},size:{type:String,default:"1em"}},setup(t){const e=t,n=w(()=>`#icon-${e.name}`);return(i,a)=>(r(),u("svg",{"aria-hidden":"true",fill:t.color,style:I("width:"+t.size+";height:"+t.size)},[o("use",{"xlink:href":n.value},null,8,rt)],12,it))}},ct={class:"product-detail-modal"},lt={class:"image-section"},ut=["src","alt"],dt={class:"info-section"},pt={class:"product-name"},_t={class:"description"},mt={class:"price"},vt={class:"stock-info"},ht={class:"stock-text"},yt={class:"stock-text"},gt={class:"purchase"},ft={class:"purchase-btn-group"},xt={__name:"ProductDetailModal",setup(t,{expose:e}){const n=x(!1),i=x(1),a=q({id:1,name:"商品名称",description:"商品描述",picture:"",price:100,quantity:1e3,remainQuantity:1e3});e({showModal:async h=>{const s=await nt(h).catch(y=>{Q.error("获取商品详情失败,请稍后再试:"+y)});s.id!=null&&(Object.assign(a,s),console.log(a),n.value=!0)}});const v=()=>{n.value=!1,Q.success("已加入购物车")};return(h,s)=>{const y=_("a-tag"),P=_("a-input-number"),$=_("a-modal");return r(),f($,{visible:n.value,"onUpdate:visible":s[1]||(s[1]=c=>n.value=c),title:"商品详情",width:1200,footer:null},{default:l(()=>[o("div",ct,[o("div",lt,[o("img",{src:a.picture,alt:a.name,class:"product-image"},null,8,ut)]),o("div",dt,[o("h2",pt,g(a.name),1),o("p",_t,g(a.description),1),o("div",mt,"售价: ￥"+g(a.price),1),o("div",vt,[o("span",ht," 已售: "+g(a.quantity-a.remainQuantity),1),o("span",yt," 剩余库存: "+g(a.remainQuantity),1),a.remainQuantity<=0?(r(),f(y,{key:0,color:"red",style:{"font-size":"12px"}},{default:l(()=>s[2]||(s[2]=[k(" 已售罄 ")])),_:1})):a.remainQuantity<=100?(r(),f(y,{key:1,color:"orange",style:{"font-size":"12px"}},{default:l(()=>s[3]||(s[3]=[k(" 库存告急 ")])),_:1})):a.quantity-a.remainQuantity<=100?(r(),f(y,{key:2,color:"green",style:{"font-size":"12px"}},{default:l(()=>s[4]||(s[4]=[k(" 新品发售 ")])),_:1})):(r(),f(y,{key:3,color:"blue",style:{"font-size":"12px"}},{default:l(()=>s[5]||(s[5]=[k("备货充足")])),_:1}))]),o("div",gt,[o("div",null,[d(P,{style:{width:"220px"},placeholder:"Please Enter",mode:"button",size:"large",class:"input-demo",modelValue:i.value,"onUpdate:modelValue":s[0]||(s[0]=c=>i.value=c),min:1,max:a.remainQuantity},null,8,["modelValue","max"])]),o("div",ft,[o("div",{class:"purchase-btn",onClick:v},[d(M,{name:"shoppingCartWhite",size:"12px"}),s[6]||(s[6]=o("span",{style:{color:"white","font-weight":"bold","font-size":"15px"}}," 加入购物车 ",-1))]),o("div",{class:"purchase-btn-2",onClick:v},[d(M,{name:"makeOrderWhite",size:"13px"}),s[7]||(s[7]=o("span",{style:{color:"white","font-weight":"bold","font-size":"15px"}}," 直接购买 ",-1))])])])])])]),_:1},8,["visible"])}}},kt=b(xt,[["__scopeId","data-v-63f5245b"]]),wt={class:"product-list"},bt={__name:"ProductList",props:{productListInfo:{type:Array,required:!0}},setup(t){const e=x(null),n=i=>{e.value.showModal(i)};return(i,a)=>{const m=_("a-col"),v=_("a-row");return r(),u("div",wt,[d(v,{gutter:16},{default:l(()=>[(r(!0),u(D,null,A(t.productListInfo,h=>(r(),f(m,{key:h.id,span:6},{default:l(()=>[d(at,{product:h,onShowProductDetailModal:n},null,8,["product"])]),_:2},1024))),128))]),_:1}),d(kt,{ref_key:"showProductDetailModalRef",ref:e},null,512)])}}},Pt=b(bt,[["__scopeId","data-v-9d45e4f6"]]),$t={class:"search"},zt={class:"search-Btn-Div"},Qt={key:0,class:"pagination-div"},St={__name:"product",setup(t){const e=x(""),n=x(!1),i=q([]),a=x(1),m=x(8),v=x(0);U(()=>{e.value="",s()});const h=()=>{e.value&&e.value.trim()!=""?y():s()},s=async()=>{n.value=!0;const c=await ot(a.value,m.value);i.splice(0,i.length,...c.data),v.value=c.totalCount,n.value=!1},y=async()=>{n.value=!0,a.value=1;const c=await st(e.value,a.value,m.value).catch(p=>{Q.error("搜索失败,请稍后再试:"+p),n.value=!1});i.splice(0,i.length,...c.data),v.value=c.totalCount,n.value=!1},P=c=>{a.value=c,e.value?y():s()},$=c=>{a.value=1,m.value=c,e.value?y():s()};return(c,p)=>{const N=_("icon-search"),V=_("a-input-search"),L=_("a-empty"),B=_("a-pagination"),O=_("a-spin");return r(),u("div",null,[o("div",$t,[p[2]||(p[2]=o("div",{class:"title"},[o("h1",{style:{margin:"0 auto","text-align":"center","font-size":"45px"}}," 优选好物 ")],-1)),o("div",zt,[d(V,{class:"search-Btn",modelValue:e.value,"onUpdate:modelValue":p[0]||(p[0]=j=>e.value=j),placeholder:"输入商品关键词","search-button":"",onSearch:h,loading:n.value},{"button-icon":l(()=>[d(N)]),"button-default":l(()=>p[1]||(p[1]=[k(" 搜好物 ")])),_:1},8,["modelValue","loading"])])]),d(O,{loading:n.value,tip:"加载中..."},{default:l(()=>[o("div",{class:F(["product-list-div",{"empty-container":i.length===0}])},[i.length===0?(r(),f(L,{key:0},{default:l(()=>p[3]||(p[3]=[k(" 没有搜索到商品 ")])),_:1})):(r(),u(D,{key:1},[d(Pt,{"product-list-info":i},null,8,["product-list-info"]),p[4]||(p[4]=o("div",{style:{height:"50px"}},null,-1)),i.length>0?(r(),u("div",Qt,[d(B,{total:v.value,current:a.value,"page-size":m.value,onChange:P,onPageSizeChange:$,"page-size-options":[8,16,32,64],"show-total":"","show-jumper":"","show-page-size":""},null,8,["total","current","page-size"])])):z("",!0)],64))],2)]),_:1},8,["loading"])])}}},Mt=b(St,[["__scopeId","data-v-cabac47a"]]);export{Mt as default};
