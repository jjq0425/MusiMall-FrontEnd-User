import{_ as C,c as $,a as c,o as a,b,d as s,t as v,r as p,e as y,w as u,f as _,n as O,g as D,h as k,i as N,j as w,M as z,F as j,k as A,l as F}from"./index-BsWbY1E5.js";import{_ as I}from"./SvgIcon-D2zKvNmu.js";const U={class:"price-stock"},E={key:0,class:"price"},R={key:1,class:"price",style:{color:"grey"}},T={class:"stock"},W={key:0,style:{color:"#f76707"}},G={key:1},X={key:2},H={key:3},J={__name:"PriceAndStockShow",props:{price:{type:Number,required:!0},remainQuantity:{type:Number,required:!0},totalQuantity:{type:Number,required:!0}},setup(e){const o=e,n=$(()=>o.price.toFixed(2)),r=$(()=>o.remainQuantity<=0),t=$(()=>o.remainQuantity<=20&&o.remainQuantity>0),m=$(()=>o.totalQuantity-o.remainQuantity<=20);return(h,g)=>(a(),c("div",U,[r.value?b("",!0):(a(),c("div",E," ￥ "+v(n.value),1)),r.value?(a(),c("div",R,"已售罄")):b("",!0),s("div",T,[t.value?(a(),c("span",W,"库存告急，仅剩"+v(e.remainQuantity)+"件",1)):m.value?(a(),c("span",G,"新品上架，欢迎选购")):r.value?(a(),c("span",X,"商品已售罄，关注其他商品吧")):(a(),c("span",H,"已售："+v(e.totalQuantity-e.remainQuantity)+" 库存: "+v(e.remainQuantity),1))])]))}},K=C(J,[["__scopeId","data-v-357e4803"]]),Y={style:{"border-radius":"12px"}},Z={__name:"ProductCard",props:{product:{type:Object,required:!0}},emits:["showProductDetailModal"],setup(e,{emit:o}){const n=e,r=()=>{t("showProductDetailModal",n.product.id)},t=o;return(m,h)=>{const g=p("a-image"),f=p("a-card-meta"),x=p("a-card");return a(),y(x,{hoverable:"",class:"product-card",onClick:r},{cover:u(()=>[s("div",Y,[_(g,{style:O([{overflow:"hidden"},{"border-radius":"12px 12px 18px 0"}]),width:"240px",height:"135px",src:e.product.picture,alt:e.product.name,preview:!1},null,8,["src","alt"])])]),default:u(()=>[_(f,{title:e.product.name,description:e.product.description.length>20?e.product.description.slice(0,18)+"...":e.product.description},{avatar:u(()=>[_(K,{style:{transform:"translateX(-5px)"},price:e.product.price,totalQuantity:e.product.quantity,remainQuantity:e.product.remainQuantity},null,8,["price","totalQuantity","remainQuantity"])]),_:1},8,["title","description"])]),_:1})}}},tt=C(Z,[["__scopeId","data-v-fed52398"]]),M="/api/product/v1",et=(e,o)=>D.get(`${M}/product`,{params:{page:e,pageSize:o,categoryName:null}}),ot=(e,o,n)=>D.get(`${M}/product/searchPage`,{params:{query:e,page:o,pageSize:n}}),at=e=>D.get(`${M}/product/${e}`),st={class:"product-detail-modal"},nt={class:"image-section"},it={class:"info-section"},rt={class:"product-name"},ct={class:"description"},lt={key:0,class:"price"},ut={key:1,class:"price",style:{color:"grey"}},dt={class:"stock-info"},pt={class:"stock-text"},_t={class:"stock-text"},mt={style:{"border-radius":"12px"},class:"footer"},vt={key:0,class:"total-price"},yt={key:1,class:"purchase"},ht={class:"purchase-btn-group"},gt={__name:"ProductDetailModal",setup(e,{expose:o}){const n=k(!1),r=k(1),t=N({id:1,name:"商品名称",description:"商品描述",picture:"",price:100,quantity:1e3,remainQuantity:1e3});o({showModal:async x=>{z.loading({content:"加载中...",id:"productDetail"});const i=await at(x).catch(P=>{z.error({content:`获取商品详情失败,请稍后再试:${P}`,id:"productDetail"})});i.id!=null&&(Object.assign(t,i),console.log(t),n.value=!0,z.success({content:"加载成功",id:"productDetail",duration:500}))}});const h=()=>{n.value=!1,z.success("已加入购物车")},g=()=>{},f=$(()=>(t.price*r.value).toFixed(2));return(x,i)=>{const P=p("a-image"),l=p("a-tag"),d=p("a-input-number"),S=p("a-modal");return a(),y(S,{visible:n.value,"onUpdate:visible":i[1]||(i[1]=Q=>n.value=Q),title:"商品详情",width:1200,footer:null},{default:u(()=>[s("div",st,[s("div",nt,[s("div",null,[_(P,{src:t.picture,alt:t.name,class:"product-image",width:"400px",height:"400px"},null,8,["src","alt"])])]),s("div",it,[s("h2",rt,v(t.name),1),s("p",ct,v(t.description),1),t.remainQuantity>0?(a(),c("div",lt," 单价: ￥"+v(t.price)+"/件 ",1)):(a(),c("div",ut,"已售罄")),s("div",dt,[s("span",pt," 已售: "+v(t.quantity-t.remainQuantity),1),s("span",_t," 剩余库存: "+v(t.remainQuantity),1),t.remainQuantity<=0?(a(),y(l,{key:0,color:"red",style:{"font-size":"12px"}},{default:u(()=>i[2]||(i[2]=[w(" 已售罄 ")])),_:1})):t.remainQuantity<=20?(a(),y(l,{key:1,color:"orange",style:{"font-size":"12px"}},{default:u(()=>i[3]||(i[3]=[w(" 库存告急 ")])),_:1})):t.quantity-t.remainQuantity<=20?(a(),y(l,{key:2,color:"green",style:{"font-size":"12px"}},{default:u(()=>i[4]||(i[4]=[w(" 新品发售 ")])),_:1})):(a(),y(l,{key:3,color:"blue",style:{"font-size":"12px"}},{default:u(()=>i[5]||(i[5]=[w("备货充足")])),_:1}))]),s("div",mt,[t.remainQuantity>0?(a(),c("div",vt,[i[6]||(i[6]=s("span",{style:{"font-weight":"bold"}},"总金额：",-1)),w(" ￥"+v(f.value),1)])):b("",!0),t.remainQuantity>0?(a(),c("div",yt,[s("div",null,[_(d,{style:{width:"220px"},placeholder:"Please Enter",mode:"button",size:"large",class:"input-demo",modelValue:r.value,"onUpdate:modelValue":i[0]||(i[0]=Q=>r.value=Q),min:1,max:t.remainQuantity},null,8,["modelValue","max"])]),s("div",ht,[s("div",{class:"purchase-btn",onClick:h},[_(I,{name:"shoppingCartWhite",size:"12px"}),i[7]||(i[7]=s("span",{style:{color:"white","font-weight":"bold","font-size":"15px"}}," 加入购物车 ",-1))]),s("div",{class:"purchase-btn-2",onClick:g},[_(I,{name:"makeOrderWhite",size:"13px"}),i[8]||(i[8]=s("span",{style:{color:"white","font-weight":"bold","font-size":"15px"}}," 直接购买 ",-1))])])])):b("",!0)])])])]),_:1},8,["visible"])}}},ft=C(gt,[["__scopeId","data-v-8f00a2f8"]]),xt={class:"product-list"},kt={__name:"ProductList",props:{productListInfo:{type:Array,required:!0}},setup(e){const o=k(null),n=r=>{o.value.showModal(r)};return(r,t)=>{const m=p("a-col"),h=p("a-row");return a(),c("div",xt,[_(h,{gutter:16},{default:u(()=>[(a(!0),c(j,null,A(e.productListInfo,g=>(a(),y(m,{key:g.id,span:6},{default:u(()=>[_(tt,{product:g,onShowProductDetailModal:n},null,8,["product"])]),_:2},1024))),128))]),_:1}),_(ft,{ref_key:"showProductDetailModalRef",ref:o},null,512)])}}},wt=C(kt,[["__scopeId","data-v-9d45e4f6"]]),bt={class:"search"},Pt={class:"search-Btn-Div"},Qt={class:"product-list-div"},$t={key:3,style:{height:"50px"}},zt={key:4,class:"pagination-div"},Ct={__name:"product",setup(e){const o=k(""),n=k(!1),r=N([]),t=k(1),m=k(8),h=k(0);F(()=>{o.value="",f()});const g=()=>{o.value&&o.value.trim()!=""?x():f()},f=async()=>{n.value=!0;const l=await et(t.value,m.value);r.splice(0,r.length,...l.data),h.value=l.totalCount,n.value=!1},x=async()=>{n.value=!0,t.value=1;const l=await ot(o.value,t.value,m.value).catch(d=>{z.error("搜索失败,请稍后再试:"+d),n.value=!1});r.splice(0,r.length,...l.data),h.value=l.totalCount,n.value=!1},i=l=>{t.value=l,o.value?x():f()},P=l=>{t.value=1,m.value=l,o.value?x():f()};return(l,d)=>{const S=p("icon-search"),Q=p("a-input-search"),q=p("a-empty"),V=p("icon-loading"),L=p("a-pagination");return a(),c("div",null,[s("div",bt,[d[2]||(d[2]=s("div",{class:"title"},[s("h1",{style:{margin:"0 auto","text-align":"center","font-size":"45px"}}," 优选好物 ")],-1)),s("div",Pt,[_(Q,{class:"search-Btn",modelValue:o.value,"onUpdate:modelValue":d[0]||(d[0]=B=>o.value=B),placeholder:"输入商品关键词","search-button":"",onSearch:g,loading:n.value},{"button-icon":u(()=>[_(S)]),"button-default":u(()=>d[1]||(d[1]=[w(" 搜好物 ")])),_:1},8,["modelValue","loading"])])]),s("div",Qt,[r.length===0&&!n.value?(a(),y(q,{key:0,style:{"padding-top":"80px"}},{default:u(()=>d[3]||(d[3]=[w(" 没有搜索到商品 ")])),_:1})):n.value?(a(),y(q,{key:1,style:{"padding-top":"80px"}},{image:u(()=>[_(V,{style:{"font-size":"68px",color:"#165dff"}})]),default:u(()=>[d[4]||(d[4]=s("div",{style:{"margin-top":"25px","font-size":"20px"}},"加载中，请稍后...",-1))]),_:1})):(a(),y(wt,{key:2,"product-list-info":r},null,8,["product-list-info"])),r.length>0&&!n.value?(a(),c("div",$t)):b("",!0),r.length>0&&!n.value?(a(),c("div",zt,[_(L,{total:h.value,current:t.value,"page-size":m.value,onChange:i,onPageSizeChange:P,"page-size-options":[8,16,32,64],"show-total":"","show-jumper":"","show-page-size":""},null,8,["total","current","page-size"])])):b("",!0)])])}}},Mt=C(Ct,[["__scopeId","data-v-7f02f86c"]]);export{Mt as default};
